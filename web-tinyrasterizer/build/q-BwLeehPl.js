import{_ as j}from"./q-BVYqaN6-.js";import{u as le,c as ce,C as ue,a as de,D as _e,b as ve,d as fe,e as pe,f as me,g as ye,l as B,h as ee,i as b,r as he,j as te,k as oe,m as ne,n as Se,o as K,p as $,q as k,s as be,t as Ce,v as we,w as ge,x as l,y as A}from"./q-DznW5W-K.js";import{y as Ee,O as qe,P as M,Q as Re,a as z,b as S,H as Pe,L as Q,A as Le,s as ke,v as re,e as Ie,z as se,J as Oe,N as $e,x as J}from"./q-BJpgaTHZ.js";import{c as X,m as Y,r as Z}from"./q-Bgy-t_W_.js";const ze=a=>{Ee(Q(()=>j(()=>Promise.resolve().then(()=>xe),void 0),"s_i0OX5Main1M"));const r=le();if(!r?.params)throw new Error("Missing Qwik City Env Data for help visit https://github.com/QwikDev/qwik/issues/6237");const m=qe("url");if(!m)throw new Error("Missing Qwik URL Env Data");const v=new URL(m),s=M({url:v,params:r.params,isNavigating:!1,prevUrl:void 0},{deep:!1}),C={},d=Re(M(r.response.loaders,{deep:!1})),y=z({type:"initial",dest:v,forceReload:!1,replaceState:!1,scroll:!0}),E=M(ce),q=M({headings:void 0,menu:void 0}),c=z(),t=r.response.action,i=t?r.response.loaders[t]:void 0,u=z(i?{id:t,data:r.response.formData,output:{result:i,status:r.response.status}}:void 0),R=Q(()=>j(()=>Promise.resolve().then(()=>Me),void 0),"s_SNVSoEmabck"),D=Q(()=>j(()=>Promise.resolve().then(()=>Ue),void 0),"s_Aqeo8lKe3IU",[u,C,y,s]);return S(ue,q),S(de,c),S(_e,E),S(ve,s),S(fe,D),S(pe,d),S(me,u),S(ye,R),Pe(Q(()=>j(()=>Promise.resolve().then(()=>De),void 0),"s_RZOV0QbO60Y",[u,q,c,E,r,D,d,C,a,y,s])),Le(ke,null,3,"P4_3")},Ae=({track:a})=>{const[r,m,v,s,C,d,y,E,q,c,t]=re();async function i(){const u=a(c),R=a(r),D=Ie(""),w=t.url,p=R?"form":u.type,ae=u.replaceState;let n,V,H=null,T;{n=new URL(u.dest,location),n.pathname.endsWith("/")||(n.pathname+="/");let x=B(Z,Y,X,n.pathname);T=se();const I=V=await ee(n,T,{action:R,clearCache:!0});if(!I){c.untrackedValue={type:p,dest:n};return}const N=I.href,O=new URL(N,n);b(O,n)||(I.isRewrite||(n=O),x=B(Z,Y,X,O.pathname));try{H=await x}catch(P){console.error(P),window.location.href=N;return}}if(H){const[x,I,N,O]=H,P=N,ie=P[P.length-1];u.dest.search&&b(n,w)&&(n.search=u.dest.search),b(n,w)||(t.prevUrl=w),t.url=n,t.params={...I},c.untrackedValue={type:p,dest:n};const L=he(V,t,P,D);m.headings=ie.headings,m.menu=O,v.value=Oe(P),s.links=L.links,s.meta=L.meta,s.styles=L.styles,s.scripts=L.scripts,s.title=L.title,s.frontmatter=L.frontmatter;{q.viewTransition!==!1&&(document.__q_view_transition__=!0);let F;p==="popstate"&&(F=te());const g=document.getElementById(oe)??document.documentElement;(u.scroll&&(!u.forceReload||!b(n,w))&&(p==="link"||p==="popstate")||p==="form"&&!b(n,w))&&(document.__q_scroll_restore__=()=>ne(p,n,w,g,F));const G=V?.loaders,e=window;if(G&&Object.assign(y,G),Se.clear(),!e._qCitySPA){if(e._qCitySPA=!0,history.scrollRestoration="manual",e.addEventListener("popstate",()=>{e._qCityScrollEnabled=!1,clearTimeout(e._qCityScrollDebounce),d(location.href,{type:"popstate"})}),e.removeEventListener("popstate",e._qCityInitPopstate),e._qCityInitPopstate=void 0,!e._qCityHistoryPatch){e._qCityHistoryPatch=!0;const _=history.pushState,h=history.replaceState,U=o=>(o===null||typeof o>"u"?o={}:o?.constructor!==Object&&(o={_data:o}),o._qCityScroll=o._qCityScroll||k(g),o);history.pushState=(o,f,W)=>(o=U(o),_.call(history,o,f,W)),history.replaceState=(o,f,W)=>(o=U(o),h.call(history,o,f,W))}document.addEventListener("click",_=>{if(_.defaultPrevented)return;const h=_.target.closest("a[href]");if(h&&!h.hasAttribute("preventdefault:click")){const U=h.getAttribute("href"),o=new URL(location.href),f=new URL(U,o);if(K(f,o)&&b(f,o)){if(_.preventDefault(),!f.hash&&!f.href.endsWith("#")){f.href!==o.href&&history.pushState(null,"",f),e._qCityScrollEnabled=!1,clearTimeout(e._qCityScrollDebounce),$({...k(g),x:0,y:0}),location.reload();return}d(h.getAttribute("href"))}}}),document.removeEventListener("click",e._qCityInitAnchors),e._qCityInitAnchors=void 0,window.navigation||(document.addEventListener("visibilitychange",()=>{if(e._qCityScrollEnabled&&document.visibilityState==="hidden"){const _=k(g);$(_)}},{passive:!0}),document.removeEventListener("visibilitychange",e._qCityInitVisibility),e._qCityInitVisibility=void 0),e.addEventListener("scroll",()=>{e._qCityScrollEnabled&&(clearTimeout(e._qCityScrollDebounce),e._qCityScrollDebounce=setTimeout(()=>{const _=k(g);$(_),e._qCityScrollDebounce=void 0},200))},{passive:!0}),removeEventListener("scroll",e._qCityInitScroll),e._qCityInitScroll=void 0,e._qCityBootstrap?.remove(),e._qCityBootstrap=void 0,be.resolve()}if(p!=="popstate"){e._qCityScrollEnabled=!1,clearTimeout(e._qCityScrollDebounce);const _=k(g);$(_)}Ce(window,p,w,n,ae),$e(T).then(()=>{we(T).setAttribute("q:route",x);const h=k(g);$(h),e._qCityScrollEnabled=!0,t.isNavigating=!1,E.r?.()})}}}i()},De=Object.freeze(Object.defineProperty({__proto__:null,_hW:J,s_RZOV0QbO60Y:Ae},Symbol.toStringTag,{value:"Module"})),Te=":root{view-transition-name:none}",xe=Object.freeze(Object.defineProperty({__proto__:null,s_i0OX5Main1M:Te},Symbol.toStringTag,{value:"Module"})),Ne=async(a,r)=>{const[m,v,s,C]=re(),{type:d="link",forceReload:y=a===void 0,replaceState:E=!1,scroll:q=!0}=typeof r=="object"?r:{forceReload:r};if(A.navCount++,d==="link"&&s.value.type==="initial"){const i=new URL(window.location.href);s.value.dest=i,C.url=i}const c=s.value.dest,t=a===void 0?c:typeof a=="number"?a:ge(a,C.url);if(l.$cbs$&&(y||typeof t=="number"||!b(t,c)||!K(t,c))){const i=A.navCount,u=await Promise.all([...l.$cbs$.values()].map(R=>R(t)));if(i!==A.navCount||u.some(Boolean)){i===A.navCount&&d==="popstate"&&history.pushState(null,"",c);return}}if(typeof t=="number"){history.go(t);return}if(!K(t,c)){location.href=t.href;return}if(!y&&b(t,c)){{d==="link"&&t.href!==location.href&&history.pushState(null,"",t);const i=document.getElementById(oe)??document.documentElement;ne(d,t,new URL(location.href),i,te()),d==="popstate"&&(window._qCityScrollEnabled=!0)}return}return s.value={type:d,dest:t,forceReload:y,replaceState:E,scroll:q},ee(t,se()),B(Z,Y,X,t.pathname),m.value=void 0,C.isNavigating=!0,new Promise(i=>{v.r=i})},Ue=Object.freeze(Object.defineProperty({__proto__:null,_hW:J,s_Aqeo8lKe3IU:Ne},Symbol.toStringTag,{value:"Module"})),je=a=>(l.$handler$||(l.$handler$=r=>{if(A.navCount++,!l.$cbs$)return;[...l.$cbs$.values()].map(v=>v.resolved?v.resolved():v()).some(Boolean)&&(r.preventDefault(),r.returnValue=!0)}),(l.$cbs$||(l.$cbs$=new Set)).add(a),a.resolve(),window.addEventListener("beforeunload",l.$handler$),()=>{l.$cbs$&&(l.$cbs$.delete(a),l.$cbs$.size||(l.$cbs$=void 0,window.removeEventListener("beforeunload",l.$handler$)))}),Me=Object.freeze(Object.defineProperty({__proto__:null,_hW:J,s_SNVSoEmabck:je},Symbol.toStringTag,{value:"Module"}));export{J as _hW,ze as s_8X6hWgnQRxE,Ne as s_Aqeo8lKe3IU,Ae as s_RZOV0QbO60Y,je as s_SNVSoEmabck,Te as s_i0OX5Main1M};
